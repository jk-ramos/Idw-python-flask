{% extends 'base.html' %}
{% block content %}

<h2>üîç Buscar Livros na API</h2>
<p class="text-muted">Pesquise livros por t√≠tulo na base do Open Library</p>

<div class="card mb-4">
    <div class="card-body">
        <form action="{{url_for('buscar_livro')}}" method="POST">
            <div class="input-group">
                <input type="text" class="form-control" name="termo_busca" 
                       placeholder="Digite o t√≠tulo do livro..." 
                       value="{{termo_busca}}" required>
                <button class="btn btn-info" type="submit">Buscar</button>
            </div>
        </form>
    </div>
</div>

{% if resultado %}
    {% if resultado is string %}
        <div class="alert alert-danger">{{resultado}}</div>
    {% else %}
        <h4>Resultados encontrados ({{resultado|length}}):</h4>
        
        <div class="row">
            {% for livro in resultado %}
            <div class="col-md-6 mb-3">
                <div class="card">
                    <div class="card-body">
                        <h6 class="card-title">{{livro.titulo}}</h6>
                        <p class="card-text small">
                            <strong>Autor:</strong> {{livro.autor}}<br>
                            <strong>Ano:</strong> {{livro.ano}}<br>
                            {% if livro.editora %}
                            <strong>Editora:</strong> {{livro.editora}}<br>
                            {% endif %}
                            {% if livro.isbn %}
                            <strong>ISBN:</strong> {{livro.isbn}}
                            {% endif %}
                        </p>
                        
                        {% if livro.isbn %}
                        <a href="{{url_for('catalogo_online', isbn=livro.isbn)}}" 
                           class="btn btn-sm btn-primary">Ver Detalhes</a>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    {% endif %}
{% elif request.method == 'POST' %}
    <div class="alert alert-warning">
        Nenhum livro encontrado para "{{termo_busca}}"
    </div>
{% endif %}

{% endblock %}

